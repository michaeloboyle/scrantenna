<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrantenna Shorts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #000;
            color: white;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        .shorts-container {
            height: 100vh;
            width: 100vw;
            position: relative;
            overflow: hidden;
        }

        .short {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .short.active {
            opacity: 1;
            transform: translateX(0);
        }

        .short.prev {
            transform: translateX(-100%);
        }

        .short.next {
            transform: translateX(100%);
        }

        .headline {
            font-size: clamp(2rem, 8vw, 4rem);
            font-weight: 900;
            line-height: 1.1;
            margin-bottom: 2rem;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
            animation: slideInUp 1s ease-out;
        }

        .headline.svo {
            font-size: clamp(1.5rem, 6vw, 3rem);
            color: #FFD700;
            font-weight: 700;
        }

        .content {
            font-size: clamp(1rem, 4vw, 1.5rem);
            line-height: 1.4;
            max-width: 80%;
            margin-bottom: 2rem;
            animation: slideInUp 1s ease-out 0.3s both;
        }

        .metadata {
            position: absolute;
            bottom: 2rem;
            left: 2rem;
            right: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            opacity: 0.8;
            animation: fadeIn 1s ease-out 0.6s both;
        }

        .source {
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .navigation {
            position: fixed;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 1rem;
            z-index: 100;
        }

        .nav-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }

        .progress-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            background: #FFD700;
            transition: width 0.3s ease;
        }

        .format-toggle {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            font-size: 0.9rem;
            z-index: 100;
        }

        .format-toggle:hover {
            background: rgba(255,255,255,0.3);
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Background patterns */
        .short:nth-child(1) { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .short:nth-child(2) { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .short:nth-child(3) { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .short:nth-child(4) { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .short:nth-child(5) { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .short {
                padding: 1rem;
            }
            
            .navigation {
                right: 1rem;
            }
            
            .format-toggle {
                top: 1rem;
                right: 1rem;
            }
            
            .metadata {
                bottom: 1rem;
                left: 1rem;
                right: 1rem;
                flex-direction: column;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="shorts-container" id="shortsContainer">
        <!-- Shorts will be dynamically loaded here -->
    </div>

    <div class="navigation">
        <button class="nav-btn" onclick="previousShort()">↑</button>
        <button class="nav-btn" onclick="nextShort()">↓</button>
    </div>

    <button class="format-toggle" onclick="toggleFormat()" id="formatToggle">
        Original
    </button>

    <script>
        let currentShort = 0;
        let shorts = [];
        let showSVO = false;

        async function loadNews() {
            try {
                // Load optimized shorts data
                const response = await fetch('shorts_data.json');
                const data = await response.json();
                
                shorts = data.shorts;
                createShorts();
                showShort(0);
                
                console.log(`Loaded ${shorts.length} shorts (${data.total_duration}s total)`);
            } catch (error) {
                console.error('Error loading shorts:', error);
                // Fallback to original news data
                try {
                    const response = await fetch('../data/daily/scranton_news_2025-06-25.json');
                    const data = await response.json();
                    
                    shorts = data.articles.slice(0, 10);
                    createShorts();
                    showShort(0);
                } catch (fallbackError) {
                    console.error('Fallback also failed:', fallbackError);
                    loadDemoData();
                }
            }
        }

        function loadDemoData() {
            shorts = [
                {
                    title: "Sample News Story",
                    title_svo: "Reporter reports story.",
                    description: "This is a sample news description for demonstration purposes.",
                    description_svo: "Article mentions demonstration purposes.",
                    source: "Demo Source",
                    publishedAt: new Date().toISOString(),
                    background_gradient: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
                }
            ];
            createShorts();
            showShort(0);
        }

        function createShorts() {
            const container = document.getElementById('shortsContainer');
            container.innerHTML = '';

            shorts.forEach((article, index) => {
                const shortDiv = document.createElement('div');
                shortDiv.className = 'short';
                if (article.background_gradient) {
                    shortDiv.style.background = article.background_gradient;
                }
                shortDiv.innerHTML = `
                    <div class="headline ${showSVO ? 'svo' : ''}" data-original="${article.title || 'No title'}" data-svo="${article.title_svo || 'No SVO title'}">
                        ${showSVO ? (article.title_svo || 'No SVO title') : (article.title || 'No title')}
                    </div>
                    <div class="content" data-original="${article.description || 'No description'}" data-svo="${article.description_svo || 'No SVO description'}">
                        ${showSVO ? (article.description_svo || 'No SVO description') : (article.description || 'No description')}
                    </div>
                    <div class="metadata">
                        <div class="source">${article.source || article.source?.name || 'Unknown Source'}</div>
                        <div class="time">${new Date(article.publishedAt).toLocaleDateString()}</div>
                    </div>
                    <div class="progress-bar" style="width: ${((index + 1) / shorts.length) * 100}%"></div>
                `;
                container.appendChild(shortDiv);
            });
        }

        function showShort(index) {
            const shortElements = document.querySelectorAll('.short');
            
            shortElements.forEach((short, i) => {
                short.classList.remove('active', 'prev', 'next');
                
                if (i === index) {
                    short.classList.add('active');
                } else if (i < index) {
                    short.classList.add('prev');
                } else {
                    short.classList.add('next');
                }
            });

            currentShort = index;
            
            // Auto-advance after 8 seconds
            setTimeout(() => {
                if (currentShort === index) { // Only advance if still on same short
                    nextShort();
                }
            }, 8000);
        }

        function nextShort() {
            const nextIndex = (currentShort + 1) % shorts.length;
            showShort(nextIndex);
        }

        function previousShort() {
            const prevIndex = currentShort === 0 ? shorts.length - 1 : currentShort - 1;
            showShort(prevIndex);
        }

        function toggleFormat() {
            showSVO = !showSVO;
            const toggleBtn = document.getElementById('formatToggle');
            toggleBtn.textContent = showSVO ? 'SVO' : 'Original';
            
            // Update all visible text
            document.querySelectorAll('.headline').forEach(headline => {
                headline.textContent = showSVO ? headline.dataset.svo : headline.dataset.original;
                headline.classList.toggle('svo', showSVO);
            });
            
            document.querySelectorAll('.content').forEach(content => {
                content.textContent = showSVO ? content.dataset.svo : content.dataset.original;
            });
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowUp':
                case 'ArrowLeft':
                    e.preventDefault();
                    previousShort();
                    break;
                case 'ArrowDown':
                case 'ArrowRight':
                case ' ':
                    e.preventDefault();
                    nextShort();
                    break;
                case 't':
                case 'f':
                    toggleFormat();
                    break;
            }
        });

        // Touch/swipe support
        let startY = 0;
        let startX = 0;

        document.addEventListener('touchstart', (e) => {
            startY = e.touches[0].clientY;
            startX = e.touches[0].clientX;
        });

        document.addEventListener('touchend', (e) => {
            const endY = e.changedTouches[0].clientY;
            const endX = e.changedTouches[0].clientX;
            const diffY = startY - endY;
            const diffX = startX - endX;
            
            // Vertical swipe (primary navigation)
            if (Math.abs(diffY) > Math.abs(diffX) && Math.abs(diffY) > 50) {
                if (diffY > 0) {
                    nextShort(); // Swipe up = next
                } else {
                    previousShort(); // Swipe down = previous
                }
            }
            // Horizontal swipe for format toggle
            else if (Math.abs(diffX) > 100) {
                toggleFormat();
            }
        });

        // Initialize
        loadNews();
    </script>
</body>
</html>